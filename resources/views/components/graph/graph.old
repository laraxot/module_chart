<div>
    <canvas id="{{ $graph_id }}" width="400" height="400"></canvas>
    @php
        $url=url_queries(['api_token'=>\Auth::user()->api_token],$url);
    @endphp
</div>
@push('scripts')
    <script>
        const ctx = document.getElementById('{{ $graph_id }}').getContext('2d');

        async function fetchData() {
            const url = "{{ $url }}";

            const options = {
                method: "GET",
                headers: {
                    'Accept': "application/json",
                    'Content-Type': 'application/json;charset=UTF-8',
                    'X-Requested-With': 'XMLHttpRequest',
                    'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content'), 
                }
            }

            const response = await fetch(url);
            const data = await response.json();
            console.log(data);
            return data;
        }

        fetchData().then(data => {
            //myChart.config.data=data;
            //myChart.update();
            const myChart = new Chart(ctx, {
                type: 'bar',
                data: data,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
    </script>
@endpush
